MQTT to InfluxDB Listener for ChirpStack Uplinks

This project implements a Python service that subscribes to an MQTT topic from a ChirpStack LoRaWAN Network Server, processes incoming uplink messages, and stores relevant metrics in InfluxDB for monitoring and analysis.

Overview

The script connects to an MQTT broker, listens for uplink messages published by ChirpStack, decodes the payload, extracts radio and device metadata, and writes the processed data into an InfluxDB bucket.

It is designed to run continuously and automatically reconnect if the MQTT connection is lost.

Features

Connects to an MQTT broker using paho-mqtt

Subscribes to a configurable MQTT topic

Parses ChirpStack uplink JSON messages

Decodes Base64 payload data

Extracts:

Device EUI

Frame counter (fCnt)

RSSI and SNR from the receiving gateway

Custom application data from the payload

Writes time-series data to InfluxDB

Uses environment variables for configuration

Automatic MQTT reconnection handling

Data Processing

For each received uplink message:

The JSON payload is parsed.

The first gateway reception (rxInfo[0]) is used.

The data field is Base64-decoded and converted to hexadecimal.

Two application-specific values are extracted:

data: First two bytes of the payload

state: Last byte of the payload

A measurement named romosa is written to InfluxDB with:

Tag: devEui

Fields: fcnt, rssi, snr, data, state

Technologies Used

Python 3

Paho MQTT Client

InfluxDB Python Client (InfluxDB 2.x)

ChirpStack MQTT Integration